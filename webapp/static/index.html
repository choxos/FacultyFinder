<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FacultyFinder - Academic Faculty Database and Research Network</title>
    
    <!-- Meta Tags -->
    <meta name="description" content="A comprehensive faculty database to help researchers, graduate students, and academics discover potential supervisors, collaborators, and faculty members across universities.">
    <meta name="keywords" content="faculty finder, academic collaboration, research, universities, professors, global, worldwide">
    <meta name="author" content="FacultyFinder Team">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/static/favicon.ico">
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@6.0.0/css/all.min.css">
    
    <!-- Custom CSS Theme -->
    <link rel="stylesheet" href="/static/css/themes/facultyfinder-theme.css">
    <link rel="stylesheet" href="/static/css/facultyfinder.css">
    <link rel="stylesheet" href="/static/css/filter-fixes.css">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-light fixed-top bg-white shadow-sm">
        <div class="container">
            <a class="navbar-brand fw-bold text-primary" href="/">
                <i class="fas fa-graduation-cap me-2"></i>
                FacultyFinder
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="/countries">Countries</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/universities">Universities</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/faculties">Faculties</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/ai-assistant">
                            <i class="fas fa-robot me-1"></i>AI Assistant
                        </a>
                    </li>
                </ul>
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <button class="btn btn-outline-secondary me-2" id="theme-toggle" type="button" title="Toggle dark/light mode">
                            <i class="fas fa-moon" id="theme-icon"></i>
                        </button>
                    </li>
                    <li class="nav-item">
                        <a class="btn btn-outline-primary me-2" href="/login">
                            <i class="fas fa-sign-in-alt me-1"></i>Sign In
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="btn btn-primary" href="/register">
                            <i class="fas fa-user-plus me-1"></i>Sign Up
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <div class="hero-section">
        <div class="container">
            <div class="row align-items-center min-vh-75">
                <div class="col-lg-6">
                    <div class="hero-content">
                        <div class="badge bg-light text-primary mb-3 fs-6 px-3 py-2">
                            <i class="fas fa-graduation-cap me-2"></i>Academic Research Network
                        </div>
                        <h1 class="display-4 fw-bold text-white mb-4">
                            Discover Faculty & 
                            <span class="text-warning">Research Collaborators</span>
                        </h1>
                        <p class="lead mb-4 text-light fs-5">
                            A comprehensive database to help researchers find potential supervisors, 
                            collaborators, and faculty members across universities. Explore detailed 
                            academic profiles and research interests to identify meaningful connections.
                        </p>
                        
                        <!-- Value Proposition Points -->
                        <div class="value-points mb-4">
                            <div class="d-flex align-items-center mb-2">
                                <i class="fas fa-university text-warning me-3"></i>
                                <span class="text-light">Browse faculty from multiple universities</span>
                            </div>
                            <div class="d-flex align-items-center mb-2">
                                <i class="fas fa-search text-warning me-3"></i>
                                <span class="text-light">Search by research areas and expertise</span>
                            </div>
                            <div class="d-flex align-items-center mb-4">
                                <i class="fas fa-robot text-warning me-3"></i>
                                <span class="text-light">AI-assisted profile matching</span>
                            </div>
                        </div>
                        
                        <!-- CTA Buttons -->
                        <div class="hero-cta">
                            <a href="/faculties" class="btn btn-warning btn-lg me-3 mb-3 px-4 py-3">
                                <i class="fas fa-search me-2"></i>Browse Faculty
                            </a>
                            <a href="/ai-assistant" class="btn btn-outline-light btn-lg mb-3 px-4 py-3">
                                <i class="fas fa-upload me-2"></i>Upload CV
                            </a>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="hero-stats-card bg-white rounded-4 shadow-lg p-4">
                        <h3 class="text-dark mb-4 text-center">Database Overview</h3>
                        <div class="row g-3">
                            <div class="col-6">
                                <div class="stat-item text-center">
                                    <div class="stat-number h2 fw-bold text-primary mb-1" id="hero-stat-professors">281</div>
                                    <div class="stat-label text-muted small">Faculty Profiles</div>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="stat-item text-center">
                                    <div class="stat-number h2 fw-bold text-success mb-1" id="hero-stat-universities">100</div>
                                    <div class="stat-label text-muted small">Universities</div>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="stat-item text-center">
                                    <div class="stat-number h2 fw-bold text-info mb-1" id="hero-stat-countries">1</div>
                                    <div class="stat-label text-muted small">Countries</div>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="stat-item text-center">
                                    <div class="stat-number h2 fw-bold text-warning mb-1">Free</div>
                                    <div class="stat-label text-muted small">Access</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Quick Search in Hero -->
                        <div class="mt-4">
                            <form action="/faculties" method="GET" class="search-form">
                                <div class="input-group">
                                    <input type="text" name="search" class="form-control form-control-lg" 
                                           placeholder="Search by name or research area...">
                                    <button class="btn btn-primary btn-lg" type="submit">
                                        <i class="fas fa-search"></i>
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Features Section -->
    <section class="features-section py-5 bg-light">
        <div class="container">
            <div class="row">
                <div class="col-12 text-center mb-5">
                    <h2 class="h3 fw-bold text-dark mb-3">Platform Features</h2>
                    <p class="lead text-muted">Tools designed to support academic research and collaboration</p>
                </div>
            </div>
            
            <!-- Key Features -->
            <div class="row g-4 mb-5">
                <div class="col-lg-3 col-md-6">
                    <div class="feature-card h-100 bg-white rounded-4 shadow-sm p-4 text-center hover-lift">
                        <div class="feature-icon mb-3">
                            <div class="icon-circle bg-primary-light">
                                <i class="fas fa-user-graduate fa-2x text-primary"></i>
                            </div>
                        </div>
                        <h5 class="feature-label fw-semibold mb-3">Faculty Profiles</h5>
                        <p class="feature-description text-muted small mb-0">
                            Detailed academic profiles including research interests, 
                            education background, and contact information
                        </p>
                    </div>
                </div>
                
                <div class="col-lg-3 col-md-6">
                    <div class="feature-card h-100 bg-white rounded-4 shadow-sm p-4 text-center hover-lift">
                        <div class="feature-icon mb-3">
                            <div class="icon-circle bg-success-light">
                                <i class="fas fa-search fa-2x text-success"></i>
                            </div>
                        </div>
                        <h5 class="feature-label fw-semibold mb-3">Advanced Search</h5>
                        <p class="feature-description text-muted small mb-0">
                            Search and filter faculty by research areas, university, 
                            department, and employment type
                        </p>
                    </div>
                </div>
                
                <div class="col-lg-3 col-md-6">
                    <div class="feature-card h-100 bg-white rounded-4 shadow-sm p-4 text-center hover-lift">
                        <div class="feature-icon mb-3">
                            <div class="icon-circle bg-info-light">
                                <i class="fas fa-robot fa-2x text-info"></i>
                            </div>
                        </div>
                        <h5 class="feature-label fw-semibold mb-3">AI Assistant</h5>
                        <p class="feature-description text-muted small mb-0">
                            Upload your CV to receive personalized faculty 
                            recommendations based on your research interests
                        </p>
                    </div>
                </div>
                
                <div class="col-lg-3 col-md-6">
                    <div class="feature-card h-100 bg-white rounded-4 shadow-sm p-4 text-center hover-lift">
                        <div class="feature-icon mb-3">
                            <div class="icon-circle bg-warning-light">
                                <i class="fas fa-map-marked-alt fa-2x text-warning"></i>
                            </div>
                        </div>
                        <h5 class="feature-label fw-semibold mb-3">Geographic View</h5>
                        <p class="feature-description text-muted small mb-0">
                            Explore universities by location with integrated 
                            maps and geographical filtering options
                        </p>
                    </div>
                </div>
            </div>
            
            <!-- About Section -->
            <div class="row">
                <div class="col-12">
                    <div class="about-section bg-white rounded-4 p-5">
                        <div class="row align-items-center">
                            <div class="col-lg-8">
                                <h3 class="h4 fw-bold mb-3">About FacultyFinder</h3>
                                <p class="mb-4">
                                    FacultyFinder is an academic research tool developed to assist graduate students, 
                                    researchers, and academic professionals in discovering potential supervisors, 
                                    collaborators, and faculty members. Our database contains verified profiles 
                                    from universities, with a focus on providing accurate and up-to-date information 
                                    to support the academic community.
                                </p>
                                <p class="mb-0 text-muted">
                                    Currently featuring faculty profiles from Canadian universities, 
                                    with plans to expand internationally as the platform grows.
                                </p>
                            </div>
                            <div class="col-lg-4 text-center">
                                <a href="/universities" class="btn btn-primary btn-lg px-4 py-3">
                                    <i class="fas fa-university me-2"></i>Browse Universities
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Top Universities Section -->
    <div class="container mb-5">
        <div class="row">
            <div class="col-12">
                <div class="section-header text-center mb-5">
                    <h2 class="fw-bold">Top Universities by Faculty Count</h2>
                    <p class="text-muted">Leading institutions with the most faculty members in our database</p>
                </div>
                
                <div class="row" id="top-universities-container">
                    <!-- Loading placeholder -->
                    <div class="col-12 text-center">
                        <div class="loading-spinner"></div>
                        <p class="mt-2 text-muted">Loading top universities...</p>
                    </div>
                </div>
                
                <div class="row mt-4">
                    <div class="col-12 text-center">
                        <a href="/universities" class="btn btn-primary btn-lg">
                            <i class="fas fa-arrow-right me-2"></i>View All Universities
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Featured Faculty Section -->
    <div class="container mb-5">
        <div class="row">
            <div class="col-12">
                <div class="section-header text-center mb-5">
                    <h2 class="h3 fw-bold">Featured Faculty</h2>
                    <p class="text-muted">Recent additions to our faculty database</p>
                </div>
                
                <div class="row" id="featured-faculty-container">
                    <!-- Loading placeholder -->
                    <div class="col-12 text-center">
                        <div class="loading-spinner"></div>
                        <p class="mt-2 text-muted">Loading featured faculty...</p>
                    </div>
                </div>
                
                <div class="row mt-4">
                    <div class="col-12 text-center">
                        <a href="/faculties" class="btn btn-primary btn-lg">
                            <i class="fas fa-arrow-right me-2"></i>View All Faculty
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Getting Started Section -->
    <section class="getting-started py-5 bg-primary text-white">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-6">
                    <div class="getting-started-content">
                        <h3 class="h4 fw-bold mb-4">
                            Get Started with FacultyFinder
                        </h3>
                        <p class="mb-4">
                            Whether you're a graduate student looking for a supervisor, 
                            a researcher seeking collaborators, or a faculty member 
                            exploring new partnerships, our platform can help you find 
                            the right academic connections.
                        </p>
                        
                        <!-- Getting Started Steps -->
                        <div class="steps mb-4">
                            <div class="d-flex align-items-center mb-3">
                                <div class="step-number me-3 bg-white bg-opacity-20 rounded-circle d-flex align-items-center justify-content-center" style="width: 30px; height: 30px;">
                                    <span class="small fw-bold">1</span>
                                </div>
                                <span>Browse faculty profiles by university or research area</span>
                            </div>
                            <div class="d-flex align-items-center mb-3">
                                <div class="step-number me-3 bg-white bg-opacity-20 rounded-circle d-flex align-items-center justify-content-center" style="width: 30px; height: 30px;">
                                    <span class="small fw-bold">2</span>
                                </div>
                                <span>Use our AI assistant for personalized recommendations</span>
                            </div>
                            <div class="d-flex align-items-center mb-4">
                                <div class="step-number me-3 bg-white bg-opacity-20 rounded-circle d-flex align-items-center justify-content-center" style="width: 30px; height: 30px;">
                                    <span class="small fw-bold">3</span>
                                </div>
                                <span>Connect with faculty members through their profiles</span>
                            </div>
                        </div>
                        
                        <!-- CTA Buttons -->
                        <div class="cta-buttons">
                            <a href="/faculties" class="btn btn-warning btn-lg me-3 mb-3 px-4 py-3">
                                <i class="fas fa-search me-2"></i>Start Browsing
                            </a>
                            <a href="/ai-assistant" class="btn btn-outline-light btn-lg mb-3 px-4 py-3">
                                <i class="fas fa-upload me-2"></i>Upload CV
                            </a>
                        </div>
                    </div>
                </div>
                
                <div class="col-lg-6">
                    <div class="getting-started-visual text-center">
                        <div class="stats-card bg-white bg-opacity-10 rounded-4 p-4">
                            <h5 class="mb-4 text-warning">Quick Stats</h5>
                            <div class="row g-3">
                                <div class="col-6">
                                    <div class="stat-item">
                                        <div class="h4 fw-bold text-white mb-1" id="cta-stat-professors">281</div>
                                        <div class="small text-light opacity-75">Faculty Profiles</div>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="stat-item">
                                        <div class="h4 fw-bold text-white mb-1" id="cta-stat-universities">100</div>
                                        <div class="small text-light opacity-75">Universities</div>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="stat-item">
                                        <div class="h4 fw-bold text-white mb-1">Free</div>
                                        <div class="small text-light opacity-75">Access</div>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="stat-item">
                                        <div class="h4 fw-bold text-white mb-1">AI</div>
                                        <div class="small text-light opacity-75">Powered</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Background Pattern -->
        <div class="position-absolute top-0 end-0 w-50 h-100 opacity-10">
            <div class="position-absolute top-50 start-50 translate-middle">
                <i class="fas fa-network-wired fa-10x text-white opacity-20"></i>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-dark text-light py-5">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <h5>
                        <i class="fas fa-graduation-cap me-2"></i>
                        FacultyFinder
                    </h5>
                    <p class="mb-3">
                        A research tool to help graduate students, researchers, and academic professionals 
                        discover faculty members and potential collaborators across universities.
                    </p>
                    <p class="mb-0">
                        &copy; 2025 FacultyFinder. All rights reserved.
                    </p>
                </div>
                <div class="col-md-3">
                    <h6 class="text-uppercase fw-bold mb-3">Quick Links</h6>
                    <ul class="list-unstyled">
                        <li class="mb-2"><a href="/faculties" class="text-light text-decoration-none">Faculty Search</a></li>
                        <li class="mb-2"><a href="/universities" class="text-light text-decoration-none">Universities</a></li>
                        <li class="mb-2"><a href="/countries" class="text-light text-decoration-none">Countries</a></li>
                        <li class="mb-2"><a href="/ai-assistant" class="text-light text-decoration-none">AI Assistant</a></li>
                        <li class="mb-2"><a href="/api/docs" class="text-light text-decoration-none">API Documentation</a></li>
                    </ul>
                </div>
                <div class="col-md-3">
                    <h6 class="fw-bold mb-3">Connect With Us</h6>
                    <div class="d-flex gap-3 mb-3">
                        <a href="#" class="text-muted"><i class="fab fa-twitter fa-lg"></i></a>
                        <a href="#" class="text-muted"><i class="fab fa-linkedin fa-lg"></i></a>
                        <a href="#" class="text-muted"><i class="fab fa-github fa-lg"></i></a>
                        <a href="#" class="text-muted"><i class="fab fa-researchgate fa-lg"></i></a>
                    </div>
                    <p class="small text-muted">
                        Follow us for updates on new features and academic collaboration opportunities.
                    </p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Custom JavaScript -->
    <script src="/static/js/facultyfinder.js"></script>
    
    <!-- Homepage Statistics and Animation -->
    <script>
        // API Base URL
        const API_BASE = '/api/v1';
        
        // Initialize stats elements with 0
        function initializeStats() {
            const statElements = ['stat-professors', 'stat-universities', 'stat-countries', 'stat-publications'];
            statElements.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.textContent = '0';
                }
            });
        }
        
        // Enhanced number animation function
        function animateNumber(elementId, targetNumber, duration = 2000) {
            const element = document.getElementById(elementId);
            if (!element) {
                console.warn(`Element with ID '${elementId}' not found`);
                return;
            }
            
            // Ensure targetNumber is valid, default to 0 if not
            const target = (!targetNumber || isNaN(targetNumber) || targetNumber < 0) ? 0 : parseInt(targetNumber);
            
            // Start from current number or 0
            const currentText = element.textContent.replace(/,/g, '');
            const startNumber = (!currentText || isNaN(parseInt(currentText))) ? 0 : parseInt(currentText);
            
            // If target is the same as current, no animation needed
            if (startNumber === target) {
                element.textContent = target.toLocaleString();
                return;
            }
            
            const startTime = Date.now();
            
            function updateNumber() {
                const elapsed = Date.now() - startTime;
                const progress = Math.min(elapsed / duration, 1);
                
                // Easing function for smooth animation (ease-out cubic)
                const easeProgress = 1 - Math.pow(1 - progress, 3);
                
                const currentNumber = Math.floor(startNumber + (target - startNumber) * easeProgress);
                
                // Update the element with formatted number
                element.textContent = currentNumber.toLocaleString();
                
                if (progress < 1) {
                    requestAnimationFrame(updateNumber);
                } else {
                    // Ensure final number is exactly the target
                    element.textContent = target.toLocaleString();
                }
            }
            
            requestAnimationFrame(updateNumber);
        }
        
        // Load statistics with enhanced error handling
        async function loadStats() {
            try {
                console.log('Loading statistics...');
                
                const response = await fetch(`${API_BASE}/stats`);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                console.log('Stats loaded:', data);
                
                // Animate numbers with fallback values and validation
                setTimeout(() => {
                    // Update main stats section
                    animateNumber('stat-professors', data.total_professors || 281);
                    animateNumber('stat-universities', data.total_universities || 100);
                    animateNumber('stat-countries', data.countries_count || 1);
                    animateNumber('stat-publications', data.total_publications || 0);
                    
                    // Update hero stats card
                    animateNumber('hero-stat-professors', data.total_professors || 281);
                    animateNumber('hero-stat-universities', data.total_universities || 100);
                    animateNumber('hero-stat-countries', data.countries_count || 1);
                }, 200); // Small delay to ensure smooth animation start
                
            } catch (error) {
                console.error('Error loading stats:', error);
                
                // Use fallback values with animation
                console.log('Using fallback statistics...');
                const fallbackStats = {
                    'stat-professors': 281,
                    'stat-universities': 100,
                    'stat-countries': 1,
                    'stat-publications': 0
                };
                
                const heroFallbackStats = {
                    'hero-stat-professors': 281,
                    'hero-stat-universities': 100,
                    'hero-stat-countries': 1
                };
                
                setTimeout(() => {
                    // Update main stats
                    Object.entries(fallbackStats).forEach(([id, value]) => {
                        animateNumber(id, value, 1500); // Slightly faster for fallback
                    });
                    
                    // Update hero stats
                    Object.entries(heroFallbackStats).forEach(([id, value]) => {
                        animateNumber(id, value, 1500);
                    });
                }, 200);
            }
        }
        
        // Load top universities
        async function loadTopUniversities() {
            try {
                const response = await fetch(`${API_BASE}/universities?per_page=6&sort_by=faculty_count`);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const data = await response.json();
                
                const container = document.getElementById('top-universities-container');
                if (!container) return;
                
                container.innerHTML = '';
                
                if (data.universities && data.universities.length > 0) {
                    data.universities.forEach(university => {
                        const universityCard = `
                            <div class="col-lg-6 col-xl-4 mb-4">
                                <div class="university-card facultyfinder-card p-4 h-100">
                                    <div class="d-flex justify-content-between align-items-start mb-3">
                                        <h5 class="mb-1">
                                            <a href="/university/${university.university_code || university.name}" class="text-decoration-none text-primary fw-bold">
                                                ${university.name || 'Unknown University'}
                                            </a>
                                        </h5>
                                        ${university.established ? 
                                            `<span class="badge bg-secondary">Est. ${university.established}</span>` : 
                                            ''
                                        }
                                    </div>
                                    
                                    <div class="mb-3">
                                        <div class="text-muted mb-2">
                                            <i class="fas fa-map-marker-alt me-2"></i>
                                            <strong>${university.city || 'Unknown'}</strong>
                                            ${university.province_state ? `, ${university.province_state}` : ''}
                                            <br>
                                            <i class="fas fa-globe me-2"></i>
                                            <strong>${university.country || 'Unknown'}</strong>
                                            ${(university.building_number && university.street) || university.full_address ? `
                                                <a href="https://www.google.com/maps/search/${encodeURIComponent(university.full_address || university.name + ' ' + university.city)}" 
                                                   target="_blank" class="btn btn-sm btn-outline-primary ms-2 google-maps-btn"
                                                   title="View on Google Maps">
                                                    <i class="fas fa-map-marked-alt me-1"></i>Maps
                                                </a>
                                            ` : ''}
                                        </div>
                                        ${(university.building_number && university.street) ? `
                                        <div class="text-muted mb-2 address-details">
                                            <i class="fas fa-home me-2"></i>
                                            <small>
                                                <strong>${university.building_number} ${university.street}</strong>
                                                ${university.postal_code ? `, ${university.postal_code}` : ''}
                                            </small>
                                        </div>
                                        ` : ''}
                                        
                                        ${university.type ? `
                                        <div class="text-muted mb-2">
                                            <i class="fas fa-building me-2"></i>
                                            <strong>${university.type}</strong>
                                        </div>
                                        ` : ''}
                                        
                                        ${university.website ? `
                                        <div class="text-muted mb-2">
                                            <i class="fas fa-link me-2"></i>
                                            <a href="${university.website}" target="_blank" class="text-decoration-none">
                                                <strong>Official Website</strong>
                                                <i class="fas fa-external-link-alt ms-1"></i>
                                            </a>
                                        </div>
                                        ` : ''}
                                    </div>
                                    
                                    <div class="mt-auto">
                                        <div class="row text-center">
                                            <div class="col-6">
                                                <div class="stat-item">
                                                    <div class="stat-number text-primary fw-bold">${university.faculty_count || 0}</div>
                                                    <div class="stat-label">Faculty</div>
                                                </div>
                                            </div>
                                            <div class="col-6">
                                                <div class="stat-item">
                                                    <div class="stat-number text-success fw-bold">${university.department_count || 0}</div>
                                                    <div class="stat-label">Departments</div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="mt-3">
                                            <a href="/faculties?university=${encodeURIComponent(university.name || '')}" class="btn btn-outline-primary btn-sm w-100">
                                                <i class="fas fa-users me-1"></i>View Faculty
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `;
                        container.innerHTML += universityCard;
                    });
                } else {
                    container.innerHTML = '<div class="col-12"><p class="text-muted text-center">No universities data available.</p></div>';
                }
                
            } catch (error) {
                console.error('Error loading top universities:', error);
                const container = document.getElementById('top-universities-container');
                if (container) {
                    container.innerHTML = '<div class="col-12"><p class="text-muted text-center">Unable to load universities at this time.</p></div>';
                }
            }
        }
        
        // Load featured faculty
        async function loadFeaturedFaculty() {
            try {
                const response = await fetch(`${API_BASE}/faculties?per_page=6&sort_by=publications`);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const data = await response.json();
                
                const container = document.getElementById('featured-faculty-container');
                if (!container) return;
                
                container.innerHTML = '';
                
                if (data.faculties && data.faculties.length > 0) {
                    data.faculties.forEach((faculty, index) => {
                        // Process research areas
                        const researchAreas = [];
                        if (faculty.research_interests) {
                            const areas = faculty.research_interests.split(/[,;]/)
                                .map(area => area.trim())
                                .filter(area => area.length > 0 && area.length < 50);
                            researchAreas.push(...areas.slice(0, 5));
                        }
                        
                        // Generate professor ID
                        const professorId = faculty.id || `prof-${index}`;
                        
                        const facultyCard = `
                            <div class="col-lg-6 col-xl-4 mb-4">
                                <div class="faculty-card h-100">
                                    <div class="card-body">
                                        <div class="faculty-info">
                                            <!-- Professor Name and Title -->
                                            <div class="faculty-header mb-3">
                                                <h5 class="card-title mb-1">
                                                    <a href="/professor/${professorId}" class="text-decoration-none professor-link">
                                                        ${faculty.name || 'Unknown Faculty'}
                                                    </a>
                                                </h5>
                                                <p class="text-muted small mb-0">
                                                    <i class="fas fa-graduation-cap me-1"></i>
                                                    <a href="/faculties?position=${encodeURIComponent(faculty.position || '')}" 
                                                       class="text-decoration-none text-muted hover-primary position-link">
                                                        ${faculty.position || 'Faculty Member'}${faculty.adjunct ? ' (Part-time)' : (!faculty.full_time ? ' (Part-time)' : '')}
                                                    </a>
                                                </p>
                                            </div>
                                            
                                            <!-- University -->
                                            <div class="faculty-affiliation mb-2">
                                                <p class="text-muted small mb-1">
                                                    <i class="fas fa-university me-1"></i>
                                                    <a href="/faculties?university=${encodeURIComponent(faculty.university_code || faculty.university_name)}" 
                                                       class="text-decoration-none text-muted hover-primary university-link">
                                                        ${faculty.university_name || 'Unknown University'}
                                                    </a>
                                                    ${faculty.university_full_address ? `
                                                        <a href="https://www.google.com/maps/search/${encodeURIComponent(faculty.university_full_address)}" 
                                                           target="_blank" 
                                                           class="text-decoration-none ms-2 maps-link"
                                                           title="View ${faculty.university_name || 'University'} on Google Maps">
                                                            <i class="fas fa-map-marker-alt text-primary"></i>
                                                        </a>
                                                    ` : ''}
                                                </p>
                                                
                                                <!-- Department -->
                                                ${faculty.department ? `
                                                <p class="text-muted small mb-0">
                                                    <i class="fas fa-building me-1"></i>
                                                    <a href="/faculties?department=${encodeURIComponent(faculty.department)}" 
                                                       class="text-decoration-none text-muted hover-primary department-link" 
                                                       title="${faculty.department}">
                                                        ${faculty.department}
                                                    </a>
                                                </p>
                                                ` : ''}
                                            </div>
                                            
                                            <!-- Research Areas -->
                                            ${researchAreas.length > 0 ? `
                                            <div class="research-areas mt-2">
                                                ${researchAreas.slice(0, 3).map(area => 
                                                    `<span class="badge bg-light text-dark border me-1 mb-1 small-research-badge">
                                                        ${area}
                                                    </span>`
                                                ).join('')}
                                                ${researchAreas.length > 3 ? 
                                                    `<span class="badge bg-secondary text-white me-1 mb-1 small-research-badge">
                                                        +${researchAreas.length - 3} more
                                                    </span>` : ''
                                                }
                                            </div>
                                            ` : ''}
                                        </div>
                                    </div>
                                    
                                    <!-- Publication Metrics Footer -->
                                    <div class="card-footer">
                                        <div class="row text-center g-0">
                                            <div class="col-4">
                                                <div class="metric-item">
                                                    <div class="metric-number text-primary">${faculty.publication_count || faculty.total_publications || 0}</div>
                                                    <div class="metric-label">Publications</div>
                                                </div>
                                            </div>
                                            <div class="col-4">
                                                <div class="metric-item">
                                                    <div class="metric-number text-success">${faculty.citation_count || 0}</div>
                                                    <div class="metric-label">Citations</div>
                                                </div>
                                            </div>
                                            <div class="col-4">
                                                <div class="metric-item">
                                                    <div class="metric-number text-warning">${faculty.h_index || 0}</div>
                                                    <div class="metric-label">H-index</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `;
                        container.innerHTML += facultyCard;
                    });
                } else {
                    container.innerHTML = '<div class="col-12"><p class="text-muted text-center">No faculty data available.</p></div>';
                }
                
            } catch (error) {
                console.error('Error loading featured faculty:', error);
                const container = document.getElementById('featured-faculty-container');
                if (container) {
                    container.innerHTML = '<div class="col-12"><p class="text-muted text-center">Unable to load faculty at this time.</p></div>';
                }
            }
        }
        
        // Show error message
        function showError(containerId, message) {
            const container = document.getElementById(containerId);
            if (container) {
                container.innerHTML = `
                    <div class="col-12">
                        <div class="alert alert-danger">
                            <i class="fas fa-exclamation-triangle me-2"></i>
                            ${message}
                        </div>
                    </div>
                `;
            }
        }
        
        // Theme toggle functionality
        function initializeTheme() {
            const themeToggle = document.getElementById('theme-toggle');
            const themeIcon = document.getElementById('theme-icon');
            const html = document.documentElement;
            
            // Check if theme toggle elements exist
            if (!themeToggle || !themeIcon) {
                console.log('Theme toggle elements not found, skipping theme initialization');
                return;
            }
            
            // Get saved theme or default to light
            const currentTheme = localStorage.getItem('theme') || 'light';
            html.setAttribute('data-theme', currentTheme);
            updateThemeIcon(currentTheme);
            
            // Theme toggle click handler
            themeToggle.addEventListener('click', function() {
                const newTheme = html.getAttribute('data-theme') === 'light' ? 'dark' : 'light';
                html.setAttribute('data-theme', newTheme);
                localStorage.setItem('theme', newTheme);
                updateThemeIcon(newTheme);
            });
            
            function updateThemeIcon(theme) {
                if (!themeIcon) return;
                
                if (theme === 'dark') {
                    themeIcon.className = 'fas fa-sun';
                    if (themeToggle) themeToggle.title = 'Switch to light mode';
                } else {
                    themeIcon.className = 'fas fa-moon';
                    if (themeToggle) themeToggle.title = 'Switch to dark mode';
                }
            }
        }

        // Enhanced page initialization
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Initializing FacultyFinder homepage...');
            
            // Initialize theme system
            initializeTheme();
            
            // Initialize stats to 0 first
            initializeStats();
            
            // Load data with slight delays for better UX
            setTimeout(() => loadStats(), 100);
            setTimeout(() => loadTopUniversities(), 300);
            setTimeout(() => loadFeaturedFaculty(), 500);
        });
        
        // Add smooth scrolling for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth'
                    });
                }
            });
        });
    </script>
</body>
</html> 